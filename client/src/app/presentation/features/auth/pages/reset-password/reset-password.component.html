<div
  class="min-h-screen flex items-center justify-center p-5 relative overflow-hidden"
  style="
    background: linear-gradient(135deg, #34495e 0%, #2c3e50 50%, #3498db 100%);
  "
>
  <!-- Animated background pattern -->
  <div class="absolute inset-0 opacity-10">
    <div
      class="absolute inset-0 bg-[repeating-linear-gradient(45deg,transparent,transparent_35px,rgba(255,255,255,0.05)_35px,rgba(255,255,255,0.05)_70px)] animate-slide"
    ></div>
  </div>

  <!-- Floating construction icon -->
  <div
    class="absolute text-9xl opacity-5 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 pointer-events-none"
  >
    🔒
  </div>

  <div
    class="bg-white rounded-3xl shadow-2xl p-12 w-full max-width-md relative z-10 animate-slideUp"
  >
    <!-- Construction decoration -->
    <div class="absolute -top-8 left-8 text-6xl animate-bounce">🔐</div>

    <div class="text-center mb-10">
      <a
        routerLink="/"
        class="inline-block text-blue-600 font-semibold text-sm mb-5 transition-all duration-300 hover:text-orange-500 hover:-translate-x-1"
      >
        ← Back to Home
      </a>

      <h1
        class="text-4xl font-black bg-gradient-to-r from-blue-600 to-orange-500 bg-clip-text text-transparent mb-2 relative"
      >
        Reset Password
        <span
          class="absolute -bottom-3 left-1/2 transform -translate-x-1/2 w-16 h-1 bg-gradient-to-r from-blue-600 to-orange-500 rounded-full"
        ></span>
      </h1>

      <p class="text-gray-600 text-lg mt-6">Enter your new password</p>
    </div>

    <!-- Success Message -->
    @if (successMessage) {
    <div
      class="bg-green-50 border-2 border-green-500 text-green-700 px-5 py-4 rounded-xl mb-6 flex items-center gap-3 animate-slideUp"
    >
      <span class="text-2xl">✅</span>
      <span>{{ successMessage }}</span>
    </div>
    }

    <!-- Error Message -->
    @if (errorMessage) {
    <div
      class="bg-red-50 border-2 border-red-500 text-red-600 px-5 py-4 rounded-xl mb-6 flex items-center gap-3 animate-slideUp"
    >
      <span class="text-2xl">🚨</span>
      <span>{{ errorMessage }}</span>
    </div>
    }

    <!-- Form -->
    @if (!successMessage) {
    <form
      [formGroup]="resetPasswordForm"
      (ngSubmit)="onSubmit()"
      class="space-y-6"
    >
      <!-- New Password Field -->
      <div>
        <label
          for="newPassword"
          class="block font-semibold text-gray-800 mb-2 text-sm uppercase tracking-wide"
        >
          New Password
        </label>
        <input
          id="newPassword"
          type="password"
          formControlName="newPassword"
          class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 bg-gray-50 focus:outline-none focus:border-blue-600 focus:bg-white focus:shadow-lg focus:-translate-y-0.5"
          [class.border-red-500]="
            resetPasswordForm.get('newPassword')?.invalid &&
            resetPasswordForm.get('newPassword')?.touched
          "
          [class.bg-red-50]="
            resetPasswordForm.get('newPassword')?.invalid &&
            resetPasswordForm.get('newPassword')?.touched
          "
          placeholder="••••••••"
        />
        @if (resetPasswordForm.get('newPassword')?.invalid &&
        resetPasswordForm.get('newPassword')?.touched) {
        <div class="mt-2 text-red-600 text-sm flex items-center gap-2">
          <span>⚠️</span>
          @if (resetPasswordForm.get('newPassword')?.hasError('required')) {
          <span>Password is required</span>
          } @if (resetPasswordForm.get('newPassword')?.hasError('minlength')) {
          <span>Password must be at least 6 characters</span>
          }
        </div>
        }
      </div>

      <!-- Confirm Password Field -->
      <div>
        <label
          for="confirmPassword"
          class="block font-semibold text-gray-800 mb-2 text-sm uppercase tracking-wide"
        >
          Confirm Password
        </label>
        <input
          id="confirmPassword"
          type="password"
          formControlName="confirmPassword"
          class="w-full px-5 py-4 border-2 border-gray-200 rounded-xl text-base transition-all duration-300 bg-gray-50 focus:outline-none focus:border-blue-600 focus:bg-white focus:shadow-lg focus:-translate-y-0.5"
          [class.border-red-500]="
            resetPasswordForm.get('confirmPassword')?.invalid &&
            resetPasswordForm.get('confirmPassword')?.touched
          "
          [class.bg-red-50]="
            resetPasswordForm.get('confirmPassword')?.invalid &&
            resetPasswordForm.get('confirmPassword')?.touched
          "
          placeholder="••••••••"
        />
        @if (resetPasswordForm.hasError('mismatch') &&
        resetPasswordForm.get('confirmPassword')?.touched) {
        <div class="mt-2 text-red-600 text-sm flex items-center gap-2">
          <span>⚠️</span>
          <span>Passwords do not match</span>
        </div>
        }
      </div>

      <!-- Submit Button -->
      <button
        type="submit"
        [disabled]="resetPasswordForm.invalid || isLoading || !userId || !code"
        class="w-full px-6 py-4 bg-gradient-to-r from-blue-600 to-orange-500 text-white rounded-xl text-lg font-bold uppercase tracking-wide transition-all duration-300 shadow-lg hover:shadow-xl hover:-translate-y-0.5 disabled:opacity-70 disabled:cursor-not-allowed disabled:transform-none relative overflow-hidden group"
      >
        <span
          class="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 -translate-x-full group-hover:translate-x-full transition-transform duration-500"
        ></span>
        @if (isLoading) {
        <span class="flex items-center justify-center gap-2">
          <span
            class="inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"
          ></span>
          <span>Resetting...</span>
        </span>
        } @else {
        <span>Reset Password</span>
        }
      </button>
    </form>
    }

    <!-- Links -->
    <div class="text-center mt-6 pt-6 border-t border-gray-200">
      <p class="text-gray-600 text-sm">
        <a
          routerLink="/login"
          class="text-blue-600 font-bold transition-all duration-300 hover:text-orange-500 relative inline-block after:content-[''] after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-blue-600 after:transition-all after:duration-300 hover:after:w-full"
        >
          Back to Login
        </a>
      </p>
    </div>
  </div>
</div>

<style>
  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide {
    to {
      background-position: 70px 70px;
    }
  }

  .animate-slideUp {
    animation: slideUp 0.6s ease-out;
  }

  .animate-slide {
    animation: slide 20s linear infinite;
  }

  .max-width-md {
    max-width: 450px;
  }
</style>
